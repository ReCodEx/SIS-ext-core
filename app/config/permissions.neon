roles:
    - name: unauthenticated

    - name: student
      parents: unauthenticated

    - name: supervisor-student
      parents: student

    - name: supervisor
      parents: supervisor-student

    - name: empowered-supervisor
      parents: supervisor

    - name: superadmin

permissions:
    - allow: true
      role: scope-master

    #######################################
    # Superadmin can do (almost) anything #
    #######################################

    - allow: false
      resource: user
      actions:
        - forceChangePassword
      conditions:
        - user.isSameUser

    - allow: true
      role: superadmin

    #############################
    # User takeover permissions #
    #############################

    - allow: true
      role: superadmin
      resource: user
      actions:
        - takeOver

    - allow: false  # A safety mechanism that prevents us from accidentaly allowing account takeover to non-admins (e.g. by wildcard rules)
      actions:
        - takeOver
